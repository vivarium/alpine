# Contributor: Luca Cantoreggi
# Maintainer: Luca Cantoreggi <luca@cantoreggi.xyz>
_realpkgname="IP2Location-C-Library"
pkgname="libip2location"
pkgver="8.0.9"
pkgrel=0
pkgdesc="IP2Location library"

url="https://www.ip2location.com/development-libraries/ip2location/c"
arch="all"
license="MIT"

makedepends="autoconf automake libtool"

subpackages="$pkgname-static $pkgname-dev"

source="${pkgname}-${pkgver}.tar.gz::https://github.com/chrislim2888/$_realpkgname/archive/$pkgver.tar.gz"

builddir="$srcdir/$_realpkgname-$pkgver"

prepare() {

	default_prepare

	cd "$builddir"

	aclocal && \
	automake && \
	autoconf && \
	autoreconf -fi
}

build() {

	cd "$builddir"

	./configure \
		--prefix=/usr \
		--exec-prefix=/usr \
		--enable-static
	
	make clean
	make
	make -C data convert
}

check() {

	cd "$builddir"

	make check
}

package() {
	
	cd "$builddir"

	make DESTDIR="$pkgdir/" install
}

static() {

	mkdir -p "$subpkgdir"/usr/lib

	mv "$pkgdir"/usr/lib/libIP2Location.a "$subpkgdir"/usr/lib/libIP2Location.a
}
